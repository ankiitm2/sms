{% extends 'Home/base.html' %}
{% load static %}
{% block body %}

<div class="page-wrapper">
    <div class="content container-fluid">
        <div class="page-header">
            <div class="row">
                <div class="col-sm-12">
                    <h3 class="page-title">Welcome {{ user.first_name }}!</h3>
                    <ul class="breadcrumb">
                        <li class="breadcrumb-item"><a href="index.html">Dashboard</a></li>
                        <li class="breadcrumb-item active">Student Dashboard</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Compact Stats Row -->
        <div class="row">
            <div class="col-xl-3 col-sm-6 col-12 mb-3">
                <div class="card bg-nine h-100">
                    <div class="card-body p-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="mb-1">All Courses</h6>
                                <h3 class="mb-0">04/06</h3>
                            </div>
                            <div class="bg-white rounded p-2">
                                <i class="fas fa-book-open text-nine"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-xl-3 col-sm-6 col-12 mb-3">
                <div class="card bg-six h-100">
                    <div class="card-body p-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="mb-1">All Projects</h6>
                                <h3 class="mb-0">40/60</h3>
                            </div>
                            <div class="bg-white rounded p-2">
                                <i class="fas fa-file-alt text-six"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-xl-3 col-sm-6 col-12 mb-3">
                <div class="card bg-ten h-100">
                    <div class="card-body p-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="mb-1">Test Attended</h6>
                                <h3 class="mb-0">30/50</h3>
                            </div>
                            <div class="bg-white rounded p-2">
                                <i class="fas fa-clipboard-list text-ten"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-xl-3 col-sm-6 col-12 mb-3">
                <div class="card bg-eleven h-100">
                    <div class="card-body p-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="mb-1">Test Passed</h6>
                                <h3 class="mb-0">15/20</h3>
                            </div>
                            <div class="bg-white rounded p-2">
                                <i class="fas fa-clipboard-check text-eleven"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Timetable Section -->
        <div class="row">
            <div class="col-lg-8">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="card-title mb-0">Today's Classes</h5>
                        <a href="{% url 'time_table' %}" class="btn btn-sm btn-primary">View Full Timetable</a>
                    </div>
                    <div class="card-body">
                        {% if todays_classes %}
                        <div class="table-responsive">
                            <table class="table table-hover mb-0">
                                <thead>
                                    <tr>
                                        <th>Time</th>
                                        <th>Subject</th>
                                        <th>Teacher</th>
                                        <th>Room</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for class in todays_classes %}
                                    <tr>
                                        <td>{{ class.start_time|time:"H:i" }} - {{ class.end_time|time:"H:i" }}</td>
                                        <td>{{ class.subject }}</td>
                                        <td>{{ class.teacher.get_full_name }}</td>
                                        <td>{{ class.classroom }}</td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                        {% else %}
                        <div class="alert alert-info">No classes scheduled for today.</div>
                        {% endif %}
                    </div>
                </div>

                <!-- Upcoming Classes Section -->
                <div class="card mt-4">
                    <div class="card-header">
                        <h5 class="card-title mb-0">Upcoming Classes</h5>
                    </div>
                    <div class="card-body">
                        {% if timetable_entries %}
                        <div class="table-responsive">
                            <table class="table table-hover mb-0">
                                <thead>
                                    <tr>
                                        <th>Day</th>
                                        <th>Time</th>
                                        <th>Subject</th>
                                        <th>Teacher</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for entry in timetable_entries %}
                                    <tr>
                                        <td>{{ entry.day }}</td>
                                        <td>{{ entry.start_time|time:"H:i" }} - {{ entry.end_time|time:"H:i" }}</td>
                                        <td>{{ entry.subject }}</td>
                                        <td>{{ entry.teacher.get_full_name }}</td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                        {% else %}
                        <div class="alert alert-info">No upcoming classes found.</div>
                        {% endif %}
                    </div>
                </div>


                <!-- Upcoming Exams Section -->
<div class="card mt-4">
    <div class="card-header">
        <h4 class="card-title">Upcoming Exams</h4>
    </div>
    <div class="card-body">
        {% if upcoming_exams %}
        <div class="table-responsive">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Exam</th>
                        <th>Subject</th>
                        <th>Time</th>
                        <th>Room</th>
                    </tr>
                </thead>
                <tbody>
                    {% for exam in upcoming_exams %}
                    <tr>
                        <td>{{ exam.date|date:"M d, Y" }}</td>
                        <td>{{ exam.name }}</td>
                        <td>{{ exam.subject }}</td>
                        <td>{{ exam.start_time|time:"H:i" }} - {{ exam.end_time|time:"H:i" }}</td>
                        <td>{{ exam.room }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <div class="text-right mt-3">
            <a href="{% url 'exam_list' %}" class="btn btn-primary">View All Exams</a>
        </div>
        {% else %}
        <p>No upcoming exams scheduled.</p>
        {% endif %}
    </div>
</div>
            </div>

            <!-- Today's Lessons -->
            <div class="col-lg-4">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title mb-0">Today's Lessons</h5>
                    </div>
                    <div class="card-body">
                        <div class="dash-circle">
                            <div class="card-body dash-widget1">
                                <div class="circle-bar circle-bar2">
                                    <div class="circle-graph2" data-percent="20">
                                        <b>20%</b>
                                    </div>
                                    <h6>Lesson Learned</h6>
                                    <h4>10 <span>/ 50</span></h4>
                                </div>
                                <div class="dash-details">
                                    <h4>Facilisi etiam</h4>
                                    <ul class="list-unstyled">
                                        <li><i class="fas fa-clock"></i> 2.30pm - 3.30pm</li>
                                        <li><i class="fas fa-book-open"></i> 5 Lessons</li>
                                        <li><i class="fas fa-hourglass-end"></i> 60 Minutes</li>
                                        <li><i class="fas fa-clipboard-check"></i> 5 Assignment</li>
                                    </ul>
                                    <div class="dash-btn">
                                        <button type="submit" class="btn btn-info btn-sm btn-border">Skip</button>
                                        <button type="submit" class="btn btn-info btn-sm">Continue</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom Row -->
        <div class="row">
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="card-title mb-0">Learning Activity</h5>
                        <select class="form-control form-control-sm w-auto">
                            <option>Weekly</option>
                            <option>Monthly</option>
                            <option>Yearly</option>
                        </select>
                    </div>
                    <div class="card-body">
                        <div id="apexcharts-area"></div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title mb-0">Learning History</h5>
                    </div>
                    <div class="card-body">
                        <ul class="list-unstyled activity-feed">
                            <li class="mb-3">
                                <div class="small text-muted">Sep 05, 9 am - 10 am (60min)</div>
                                <a class="d-block">Lorem ipsum dolor</a>
                                <span class="badge badge-info">In Progress</span>
                            </li>
                            <li class="mb-3">
                                <div class="small text-muted">Sep 04, 2 pm - 3 pm (70min)</div>
                                <a class="d-block">Et dolore magna</a>
                                <span class="badge badge-success">Completed</span>
                            </li>
                            <li class="mb-3">
                                <div class="small text-muted">Sep 02, 1 pm - 2 am (80min)</div>
                                <a class="d-block">Exercitation ullamco</a>
                                <span class="badge badge-info">In Progress</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Include your scripts here -->
<script src="{%static 'assets/js/jquery-3.6.0.min.js' %}"></script>
<script src="{%static 'assets/js/popper.min.js' %}"></script>
<script src="{%static 'assets/plugins/bootstrap/js/bootstrap.min.js' %}"></script>
<script src="{%static 'assets/plugins/slimscroll/jquery.slimscroll.min.js' %}"></script>
<script src="{%static 'assets/plugins/apexchart/apexcharts.min.js' %}"></script>
<script src="{%static 'assets/plugins/apexchart/chart-data.js' %}"></script>
<script src="{%static 'assets/js/circle-progress.min.js' %}"></script>
<script src="{%static 'assets/js/script.js' %}"></script>

<style>
    .card {
        margin-bottom: 20px;
    }
    .circle-bar {
        margin: 0 auto 15px;
    }
    .dash-details h4 {
        font-size: 1.1rem;
        margin-bottom: 10px;
    }
    .dash-details ul {
        margin-bottom: 15px;
    }
    .dash-details ul li {
        margin-bottom: 5px;
    }
    .dash-btn .btn {
        padding: 0.25rem 0.5rem;
        font-size: 0.875rem;
    }
    .activity-feed li {
        padding: 8px 0;
        border-bottom: 1px solid #eee;
    }
    .activity-feed li:last-child {
        border-bottom: none;
    }
</style>

{% endblock %}